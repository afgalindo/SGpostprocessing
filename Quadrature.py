import numpy as np

class Quadrature: #Class called Quadrature. This contains the gauss points and weights.
    def __init__(self, N_quad):
        self.N_quad = N_quad # number of gauss quadrature points
        self.w = np.empty(N_quad) # weights
        self.g = np.empty(N_quad) # abcissa
        self.construct_quad()
    
    def construct_quad(self): # we'll only consider number of gauss quad points to be 2, 3, 4, or 8
        if self.N_quad == 2:
            self.w[:]=[1.0000000000000000, 1.0000000000000000]
            self.g[:]=[-0.57773502691896257, 0.57773502691896257]

        elif self.N_quad == 3:
            self.w[:]=[0.8888888888888888, 0.5555555555555556, 0.5555555555555556]
            self.g[:]=[0.0000000000000000, -0.7745966692414834, 0.7745966692414834]

        elif self.N_quad == 4:
            self.w[:]=[0.6521451548625461, 0.6521451548625461, 0.3478548451374538, 0.3478548451374538]
            self.g[:]=[-0.3399810435848563, 0.3399810435848563, -0.8611363115940526, 0.8611363115940526]
        elif self.N_quad == 7:
            self.w[:]=[0.4179591836734694,0.3818300505051189,0.3818300505051189,0.2797053914892766, 0.2797053914892766,0.1294849661688697,0.1294849661688697]	
            self.g[:]=[0.0, -0.4058451513773972, 0.4058451513773972, -0.7415311855993945, 0.7415311855993945, -0.9491079123427585, 0.9491079123427585]
        elif self.N_quad == 8:
            self.w[:]=[0.3626837833783620, 0.3626837833783620, 0.3137066458778873, 0.3137066458778873, 0.2223810344533745, 0.2223810344533745, 0.1012285362903763, 0.1012285362903763]
            self.g[:]=[-0.1834346424956498, 0.1834346424956498, -0.5255324099163290, 0.5255324099163290, -0.7966664774136267, 0.7966664774136267, -0.9602898564975363, 0.9602898564975363]
        elif self.N_quad == 9: 
            self.w[:]=[0.3302393550012598,0.1806481606948574,0.1806481606948574,0.081274388361574,0.0812743883615744,0.3123470770400029,0.3123470770400029,0.2606106964029354,0.2606106964029354]
            self.g[:]=[0.0,-0.8360311073266358,0.8360311073266358,-0.9681602395076261,0.9681602395076261,-0.3242534234038089,0.3242534234038089,-0.6133714327005904,0.6133714327005904]
        elif self.N_quad ==13:
            self.w[:]=[0.2325515532308739,0.2262831802628972,0.2262831802628972,0.2078160475368885,0.2078160475368885,0.1781459807619457,0.1781459807619457,0.1388735102197872,0.1388735102197872,0.0921214998377285,0.0921214998377285,0.0404840047653159,0.0404840047653159]
            self.g[:]=[0.0,-0.2304583159551348,0.2304583159551348,-0.4484927510364469,0.4484927510364469,-0.6423493394403402,0.6423493394403402,-0.8015780907333099,0.8015780907333099,-0.9175983992229779,0.9175983992229779,-0.9841830547185881,0.9841830547185881]
        elif self.N_quad ==14:
            self.w[:]=[0.2152638534631578,0.2152638534631578,0.2051984637212956,0.2051984637212956,0.1855383974779378,0.1855383974779378,0.1572031671581935,0.1572031671581935,0.1215185706879032,0.1215185706879032,0.0801580871597602,0.0801580871597602,0.0351194603317519,0.0351194603317519]
            self.g[:]=[-0.1080549487073437,0.1080549487073437,-0.3191123689278897,0.3191123689278897,-0.5152486363581541,0.5152486363581541,-0.6872929048116855,0.6872929048116855,-0.8272013150697650,0.8272013150697650,-0.9284348836635735,0.9284348836635735,-0.9862838086968123,0.9862838086968123]
    def return_quadrature(self): #Returns quadrature absicas and weights.
        return self.g, self.w
